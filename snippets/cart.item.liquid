<article class="cart-item product-item slider-v visible" 
         data-cart-item="{{ item.key }}" 
         data-item-count="{{ item.quantity }}" 
         data-cart-count="{% if count %}2{% else %}{{ cart.item_count }}{% endif %}" 
         data-revealer-visible="true">  
  <div class="cart-item-content">    
    <div class="cart-item-column cart-item-column-image cart-item-image">      
      {%- liquid   
        assign product_item_style = settings.product_item_style
        if settings.enable_image_crop and product_item_style != 'natural'
          assign product_item_style = product_item_style | prepend: 'cropped-'
        endif
      -%}
      <figure class="product-item-image product-item-style-{{ product_item_style }} {{ settings.insta_filter }} relative">
        <a href="{{ item.url }}" title="{{ item.product.title | escape }}" class="{{ settings.insta_filter }}" tabindex="-1">
          {%- liquid
            render 'image.sizes', size: 90
            assign crop = settings.enable_image_crop
            case settings.product_item_style
              when 'natural'
                assign padding = product.featured_media.preview_image.aspect_ratio | times: 100
                assign crop = false
              when 'small'
                assign padding = 75
              when 'medium'
                assign padding = 100
              when 'large'
                assign padding = 150
            endcase
            if settings.enable_image_crop
              assign image_position = '50-50'
            endif
            if is_cart
              assign sizes = '(min-width: 640px) 90px, 50px'
            else
              assign sizes = '(min-width: 660px) 90px, 50px'
            endif
            if item.image             
              capture alt
                if item.image.alt != blank
                  echo item.image.alt | escape
                else
                  echo item.product.title | escape
                endif
              endcapture
              render 'image.load', img_src: item.image, size: 90, new_size: 90, padding: padding, image_position: image_position, sizes: sizes, alt: alt, loop: true, crop: crop, lazy: lazy      
            elsif settings.product_item_placeholder != blank          
              capture alt
                if settings.product_item_placeholder.alt != blank
                  echo settings.product_item_placeholder.alt | escape
                else
                  echo item.product.title | escape
                endif
              endcapture
              render 'image.load', img_src: settings.product_item_placeholder, size: 90, new_size: 90, padding: padding, image_position: image_position, sizes: sizes, alt: alt, loop: true, crop: crop, lazy: lazy
            else
              assign index = forloop.index0 | modulo: 4 | plus: 1
              echo 'product-apparel-' | append: index | placeholder_svg_tag: 'placeholder-svg'
            endif
          -%}
        </a>
      </figure>
      <button class="cart-item-remove" 
              type="button" 
              aria-label="{{ 'cart.remove_item' | t | escape }}" 
              data-cart-item-remove>{%- render 'icons.theme', id: 'trash', size: 18 -%}</button>
      <noscript><a href="{{ item.url_to_remove }}" title="{{ 'cart.remove_item' | t | escape }}" class="cart-item-remove no-js">{%- render 'icons.theme', id: 'trash', size: 18 -%}</a></noscript>
    </div>
    <div class="cart-item-column cart-item-column-information">
      <div class="cart-item-information-row column">
        <div class="cart-item-information-column">
          <span class="cart-item-title">
            <a href="{{ item.url }}" title="{{ item.product.title | escape }}">{{ item.product.title }}</a>
          </span>  
          <div class="cart-item-prices">            
            {% if item.original_price > item.final_price %}
              <span class="money cart-item-price cart-item-original-price">{% if settings.currency_enable %}{{ item.original_price | money_with_currency }}{% else %}{{ item.original_price | money }}{% endif %}</span>
            {% elsif item.variant.compare_at_price > item.variant.price %}
              <span class="money cart-item-price cart-item-original-price">{% if settings.currency_enable %}{{ item.variant.compare_at_price | money_with_currency }}{% else %}{{ item.variant.compare_at_price | money }}{% endif %}</span>
            {% endif %}  
            <span class="money cart-item-price cart-item-final-price">{% if settings.currency_enable %}{{ item.final_price | money_with_currency }}{% else %}{{ item.final_price | money }}{% endif %}</span>
            {% if item.unit_price %}
              {%- assign variant_for_unit_price = item -%}
              {%- capture unit_price -%}
                <span class="product-price__unit-price-amount money" data-unit-price-amount>{% if settings.currency_enable %}{{ variant_for_unit_price.unit_price | money_with_currency }}{% else %}{{ variant_for_unit_price.unit_price | money }}{% endif %}</span>
              {%- endcapture -%}
              {%- capture unit_measure -%}
                <span class="product-price__unit-price-measure" data-unit-price-measure>
                  {% if variant_for_unit_price.unit_price_measurement.reference_value != 1 %}{{ variant_for_unit_price.unit_price_measurement.reference_value }}{% endif %}{{ variant_for_unit_price.unit_price_measurement.reference_unit }}
                </span>
              {% endcapture %}          
              <div class="product-price__unit-price{% unless variant_for_unit_price.unit_price_measurement %} hidden{% endunless %}" data-unit-price>
                {{ 'product.price_per_unit_html' | t: unit_price: unit_price, unit_measure: unit_measure | strip_newlines }}
              </div>          
              {%- assign variant_for_unit_price = blank -%}
            {% endif %}  
          </div>  
          {% if item.discount_allocations.size > 0 %}
            <div class="cart-item-discounts">
              {% for discount_allocation in item.line_level_discount_allocations %}
                <span class="cart-item-discount">
                  {%- render 'icons.theme', id: 'sale-tag', class: ' cart-discount-sale-tag', size: 11 -%}
                  {{ discount_allocation.discount_application.title }} (-<span class="money">{% if settings.currency_enable %}{{ discount_allocation.amount | money_with_currency }}{% else %}{{ discount_allocation.amount | money }}{% endif %}</span>)
                </span>
              {% endfor %}
            </div>
          {% endif %}
          {% unless item.variant.title == 'Default Title' %}
            <span class="cart-item-options">{{ item.variant.title | replace: ' /', ' | ' }}</span>
          {% endunless %}  
          {%- liquid
            if item.selling_plan_allocation
              echo '<p>'
              echo item.selling_plan_allocation.selling_plan.name
              echo '</p>'
            endif
            assign property_size = item.properties | size
            if property_size > 0
              echo '<p>'
              for p in item.properties
                assign property_first_char = p.first | slice: 0
                if p.last != blank and property_first_char != '_'
                  echo '<strong>'
                  echo p.first
                  echo ':</strong> '
                  if p.last contains '/uploads/'
                    echo '<a href="'
                    echo p.last
                    echo '" title="'
                    echo p.last | split: '/' | last | escape
                    echo '">'
                    echo p.last | split: '/' | last
                    echo '</a>'
                  else
                    echo p.last | date: format: settings.month_day_year
                  endif
                  unless forloop.last
                    echo '<br/>'
                  endunless
                endif
              endfor
              echo '</p>'
            endif
          -%}
          <p><small>{{ 'cart.qty_html' | t: qty: item.quantity }}</small></p>
        </div>
        <div class="cart-item-information-column">
          
        </div>
      </div>
      <div class="cart-item-information-row">
        <div class="cart-item-quantity">
          {%- liquid
            if quantity_enable or is_ajax
              render 'product.quantity', block: item.variant, variant: item.variant, value: item.quantity, input_name: 'updates[]', sticky: true
            endif
          -%}
        </div>        
        <div class="cart-item-line-prices">        
          {% if item.original_line_price != item.final_line_price %}
            <span class="money cart-item-line-price cart-item-original-line-price">{% if settings.currency_enable %}{{ item.original_line_price | money_with_currency }}{% else %}{{ item.original_line_price | money }}{% endif %}</span>
          {% elsif item.variant.compare_at_price > item.original_price %}
            <span class="money cart-item-line-price cart-item-original-line-price">{% if settings.currency_enable %}{{ item.variant.compare_at_price | times: item.quantity | money_with_currency }}{% else %}{{ item.variant.compare_at_price | times: item.quantity | money }}{% endif %}</span>
          {% endif %}
          <span class="money cart-item-line-price cart-item-final-line-price">{% if settings.currency_enable %}{{ item.final_line_price | money_with_currency }}{% else %}{{ item.final_line_price | money }}{% endif %}</span>
        </div>        
      </div>      
    </div>
  </div>
</article>